
model Pers {
  persId Int    @id @default(autoincrement()) @map("pers_id")
  userId Int    @map("user_id")
  name   String @db.VarChar(100)
  level  Int    @default(1)

  currentSpellSlots Int[] @default([]) @map("current_spell_slots")

  classId    Int  @map("class_id")
  subclassId Int? @map("subclass_id")

  backgroundId Int @map("background_id")

  raceId    Int  @map("race_id")
  subraceId Int? @map("subrace_id")

  currentHp Int @map("current_hp")
  maxHp     Int @map("max_hp")
  tempHp    Int @default(0) @map("temp_hp")

  persSpells PersSpell[]

  raceCustom           String @default("") @map("race_custom") @db.VarChar(100)
  classCustom          String @default("") @map("class_custom") @db.VarChar(100)
  alignment            String @default("") @db.VarChar(100)
  xp                   Int    @default(0)
  customBackground     String @default("") @map("custom_background") @db.VarChar(100)
  customFeatures       String @default("") @map("custom_features") @db.Text
  customLanguagesKnown String @default("") @map("custom_languages_known") @db.Text
  customEquipment      String @default("") @map("custom_equipment") @db.Text
  personalityTraits    String @default("") @map("personality_traits") @db.Text
  ideals               String @default("") @db.Text
  bonds                String @default("") @db.Text
  flaws                String @default("") @db.Text
  backstory            String @default("") @db.Text
  notes                String @default("") @db.Text

  str Int
  dex Int
  con Int
  int Int
  wis Int
  cha Int

  cp String @default("0")
  ep String @default("0")
  sp String @default("0")
  gp String @default("0")
  pp String @default("0")

  additionalSaveProficiencies Ability[] @default([]) @map("additional_save_proficiencies")
  miscSaveBonuses             Json?     @map("misc_save_bonuses")

  wearsShield           Boolean @default(false) @map("wears_shield")
  additionalShieldBonus Int     @default(0) @map("additional_shield_bonus")
  armorBonus            Int     @default(0) @map("armor_bonus")
  wearsNaturalArmor     Boolean @default(false) @map("wears_natural_armor")

  user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  class      Class      @relation(fields: [classId], references: [classId])
  subclass   Subclass?  @relation(fields: [subclassId], references: [subclassId])
  race       Race       @relation(fields: [raceId], references: [raceId])
  subrace    Subrace?   @relation(fields: [subraceId], references: [subraceId])
  background Background @relation(fields: [backgroundId], references: [backgroundId])

  skills                PersSkill[]
  multiclasses          PersMulticlass[]
  features              PersFeature[]
  spells                Spell[]
  feats                 PersFeat[]
  armors                PersArmor[]
  weapons               PersWeapon[]
  magicItems            PersMagicItem[]
  raceVariants          RaceVariant[]
  raceChoiceOptions     RaceChoiceOption[]
  choiceOptions         ChoiceOption[]
  classOptionalFeatures ClassOptionalFeature[]

  // Opposite side of PersInfusion.pers
  persInfusions PersInfusion[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("pers")
}
